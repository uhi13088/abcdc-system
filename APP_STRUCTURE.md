# 앱 구조 및 사용자 시나리오

## 📱 전체 앱 구성 (최종안)

```
🏢 ABC 통합 관리 시스템

┌─────────────────────────────────────────────────────────┐
│                    플랫폼 레벨                            │
├─────────────────────────────────────────────────────────┤
│ 🌐 랜딩페이지 (https://abcstaff.com)                     │
│    - 고객 유치, 요금제, 무료 체험 신청                    │
│                                                         │
│ 🔧 플랫폼 대시보드 (https://admin.abcstaff.com)           │
│    - super_admin 전용                                   │
│    - 전체 회사 관리, 구독/결제, 근로기준법 업데이트        │
└─────────────────────────────────────────────────────────┘

┌─────────────────────────────────────────────────────────┐
│              Staff System (직원 관리)                     │
├─────────────────────────────────────────────────────────┤
│ 💼 관리자 대시보드 (https://app.abcstaff.com)             │
│    - 웹 버전 (데스크톱)                                   │
│    - 대상: company_admin, manager, store_manager        │
│    - 기능: 직원관리, 급여, 스케줄, 승인, 계약서            │
│                                                         │
│ 📱 관리자 모바일 앱 (iOS/Android)                         │
│    - 앱 이름: "ABC 매니저"                               │
│    - 대상: 매장/식당 관리자                               │
│    - 기능: 출퇴근 현황, 승인 처리, 긴급 근무 모집          │
│                                                         │
│ 📱 직원 모바일 앱 (iOS/Android)                          │
│    - 앱 이름: "ABC 직원"                                 │
│    - 대상: 일반 직원 (아르바이트, 정규직)                  │
│    - 기능: QR 출퇴근, 급여 조회, 스케줄, 휴가 신청         │
└─────────────────────────────────────────────────────────┘

┌─────────────────────────────────────────────────────────┐
│              HACCP System (공장 관리)                     │
├─────────────────────────────────────────────────────────┤
│ 💼 HACCP 대시보드 (https://haccp.abcstaff.com)            │
│    - 웹 버전 (데스크톱)                                   │
│    - 대상: HACCP팀장, 품질관리자, 공장장                  │
│    - 기능: 전체 현황, 리포트, 설정, 센서 관리              │
│                                                         │
│ 📱 HACCP 모바일 앱 (iOS/Android) ⭐                       │
│    - 앱 이름: "ABC HACCP"                                │
│    - 대상: 생산담당자, 품질담당자, 위생담당자              │
│    - 기능: 일일점검, CCP 기록, 입고검사, 생산기록, 센서    │
└─────────────────────────────────────────────────────────┘
```

---

## 🎯 권장 구조: **별도 앱** (HACCP 전용)

### 이유:

#### ✅ **역할 분리 명확**
```
일반 직원 (식당/매장)
  └─ "ABC 직원" 앱
      - QR 출퇴근
      - 급여 조회
      - 스케줄 확인

매장 관리자
  └─ "ABC 매니저" 앱
      - 직원 관리
      - 승인 처리
      - 출퇴근 현황

공장 직원 (생산/품질/위생)
  └─ "ABC HACCP" 앱
      - 일일 점검
      - CCP 기록
      - 입고 검사
      - 센서 관리
```

#### ✅ **사용자 혼란 방지**
```
❌ 나쁜 예 (통합 앱):
알바생 앱 실행 → 메뉴에 "CCP 모니터링", "원료 수불" 표시
→ "이게 뭐지? 왜 이렇게 복잡해?" 😵

✅ 좋은 예 (분리):
알바생: "ABC 직원" 앱 → 출퇴근만 보임 ✨
공장 담당자: "ABC HACCP" 앱 → HACCP 기능만 보임 ✨
```

#### ✅ **전문성 향상**
```
"ABC HACCP"
- HACCP 전문 용어 사용 가능
- 공장 작업 흐름에 최적화
- 복잡한 기록 양식 지원
- 센서 관리 도구

vs

"ABC 직원" (통합 시)
- 모든 사용자 고려해야 함
- 단순한 UI 유지 필요
- HACCP 기능이 숨겨지거나 접근성 떨어짐
```

#### ✅ **앱 용량 절약**
```
"ABC 직원": 20MB (가볍고 빠름)
"ABC HACCP": 35MB (센서 라이브러리, 차트 등 포함)

vs

통합 앱: 55MB (모든 사용자가 불필요한 기능까지 다운로드)
```

---

## 🔗 데이터 연동

### 공통 데이터베이스

```sql
-- 동일 DB 사용 (PostgreSQL)
-- RLS로 회사별 격리

공통 테이블:
- companies
- users ⭐ (직원 정보 공유)
- brands
- stores

Staff System 전용:
- attendances (출퇴근)
- salaries (급여)
- schedules
- approval_requests
- contracts

HACCP System 전용:
- products
- materials
- ccp_records
- daily_hygiene_checks
- material_inspections
- production_records
- iot_sensors
```

### 연동 포인트

```typescript
// 1. 출퇴근 시 건강 체크 자동 연동
// Staff System (직원 앱)
await checkIn(qrCode);

// 자동으로 HACCP 건강 체크 생성
if (user.role === 'FACTORY_WORKER') {
  await createHealthCheck({
    staffId: user.id,
    checkDate: new Date(),
    bodyTemperature: await promptTemperature(),
    symptoms: await promptSymptoms()
  });
}

// 2. 작업자 선택 시 공유
// HACCP 앱에서 생산 기록 시
<MultiSelect 
  label="작업자"
  items={await db.users.where('role', 'in', ['PRODUCTION', 'QC']).get()}
/>

// 3. 교육 이력 공유
// Staff System에서 교육 등록
await createTraining({
  trainingName: 'HACCP 기본 교육',
  attendees: [...]
});

// HACCP 앱에서 권한 확인 시 자동 참조
const hasTraining = await checkTraining(userId, 'HACCP_BASIC');
```

---

## 👥 사용자별 설치 앱

### 시나리오 1: 식당 체인 (HACCP 없음)

```
사장님 (company_admin)
  📱 "ABC 매니저" 앱
  💻 웹 대시보드 (app.abcstaff.com)

매장 관리자 (store_manager)
  📱 "ABC 매니저" 앱

알바/직원 (staff)
  📱 "ABC 직원" 앱
```

### 시나리오 2: 식품 제조 공장 (HACCP 필수)

```
사장님 (company_admin)
  📱 "ABC 매니저" 앱 (인사/급여용)
  💻 HACCP 대시보드 (haccp.abcstaff.com)

HACCP 팀장
  📱 "ABC HACCP" 앱
  💻 HACCP 대시보드

생산 담당자
  📱 "ABC HACCP" 앱
  📱 "ABC 직원" 앱 (출퇴근용)

품질 담당자
  📱 "ABC HACCP" 앱
  📱 "ABC 직원" 앱 (출퇴근용)

일반 공장 직원 (생산 라인)
  📱 "ABC 직원" 앱 (출퇴근만)
```

### 시나리오 3: 식당 + 센트럴 키친 (복합)

```
본사 (식당 운영 + 센트럴 키친)

본사 관리자
  📱 "ABC 매니저" 앱 (전체 매장 관리)
  💻 웹 대시보드

센트럴 키친 담당자
  📱 "ABC HACCP" 앱 (생산 관리)
  📱 "ABC 직원" 앱 (출퇴근)

매장 관리자
  📱 "ABC 매니저" 앱

매장 직원
  📱 "ABC 직원" 앱
```

---

## 📊 앱별 기능 비교

| 기능 | ABC 직원 | ABC 매니저 | ABC HACCP |
|-----|---------|-----------|-----------|
| **출퇴근** | ✅ QR 체크인 | ✅ 현황 조회 | ✅ QR 체크인 |
| **급여** | ✅ 조회 | ✅ 관리 | ✅ 조회 |
| **스케줄** | ✅ 조회 | ✅ 관리 | - |
| **휴가 신청** | ✅ | ✅ 승인 | - |
| **승인 처리** | - | ✅ | - |
| **직원 관리** | - | ✅ | - |
| **일일 점검** | - | - | ✅ |
| **CCP 모니터링** | - | - | ✅ |
| **입고 검사** | - | - | ✅ |
| **생산 기록** | - | - | ✅ |
| **센서 관리** | - | - | ✅ |
| **재고 관리** | - | - | ✅ |
| **IoT 대시보드** | - | - | ✅ |

---

## 🎨 앱 디자인 차별화

### "ABC 직원" (단순, 친근)
```
색상: 파란색 (#3B82F6)
톤: 친근하고 쉬운 말투
아이콘: 큼직하고 직관적
화면: 최소한의 정보

예: "출근하기", "급여 확인", "휴가 신청"
```

### "ABC 매니저" (전문, 효율)
```
색상: 남색 (#1E40AF)
톤: 전문적이고 간결
아이콘: 세밀하고 많은 정보
화면: 다양한 통계 표시

예: "승인 대기 12건", "오늘 지각 3명", "긴급 근무 모집"
```

### "ABC HACCP" (전문, 안전)
```
색상: 초록색 (#059669) + 빨간색 (경고)
톤: 정확하고 전문적
아이콘: HACCP 전문 아이콘
화면: 상세한 폼과 차트

예: "CCP-1 기록", "한계기준 초과", "부적합 조치"
```

---

## 💰 비용 영향

### 별도 앱 개발 시

```
개발 비용:
- ABC 직원: 4주
- ABC 매니저: 5주
- ABC HACCP: 6주 (센서 연동 포함)
총: 15주

vs 통합 앱: 12주 (복잡도로 인한 버그 많음)
```

### 유지보수

```
별도 앱:
- 각 앱 독립적 업데이트
- 한 앱 문제 발생 시 다른 앱 영향 없음
- 사용자별 맞춤 개선 가능

통합 앱:
- 한 번 업데이트 시 모든 사용자 영향
- 복잡도 증가로 버그 발생 확률 높음
- 특정 기능 개선 어려움
```

---

## ✅ 최종 권장 사항

### **별도 앱으로 개발** (3개 모바일 앱)

```
1. 📱 ABC 직원 (가장 많은 사용자)
   - 대상: 일반 직원, 아르바이트
   - 목적: 출퇴근, 급여, 스케줄
   - 우선순위: 최우선 (매출 직결)

2. 📱 ABC 매니저 (중간 관리층)
   - 대상: 매장/식당 관리자
   - 목적: 직원 관리, 승인 처리
   - 우선순위: 높음

3. 📱 ABC HACCP (전문가)
   - 대상: 공장 생산/품질/위생 담당자
   - 목적: HACCP 기록, 센서 관리
   - 우선순위: 중간 (특정 고객만)
```

### 개발 순서

```
Phase 1 (12주): Staff System
  - ABC 직원 앱
  - ABC 매니저 앱
  - 웹 대시보드

Phase 2 (6주): HACCP System
  - ABC HACCP 앱
  - HACCP 웹 대시보드
  - 센서 연동
```

---

## 🎯 결론

**"ABC HACCP"는 별도 모바일 앱으로 개발**

이유:
✅ 역할 분리 명확
✅ 사용자 혼란 방지
✅ 전문성 향상
✅ 독립적 업데이트 가능
✅ 앱 용량 최적화

데이터는 공유하지만, 앱은 분리! 🚀
